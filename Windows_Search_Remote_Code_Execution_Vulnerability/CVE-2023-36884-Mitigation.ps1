#CVE-2023-36884 
#Windows Search Remote Code Execution Vulnerability

function editProtocol($path){
  Get-ItemProperty $path
}

if(Test-Path 'HKCR:\ms-search'){
 Write-Output "Route founded"
 editProtocol 'HKCR:\ms-search'
}
else{
 Write-Output "Route not founded,creating route..."
 New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT
 editProtocol 'HKCR:\ms-search'
}
